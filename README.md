# Gemini Notes Aggregator for Google Docs

This Apps Script automates the process of collecting and merging Gemini-generated meeting notes into a single Google Docs file. It's designed to simplify importing meeting summaries into tools like **NotebookLM**, where having all notes in one structured document is beneficial.

## âœ¨ What the Script Does

- Searches the `Meet Recordings` folder in Google Drive for Google Docs whose filenames:
  - start with `TRT` in this case
  - end with `Notes by Gemini`
- Sorts matching documents by creation date (oldest first)
- Extracts their content using a `.docx` conversion workaround to preserve formatting
- Inserts each note section at the **top** of the current document, with:
  - a heading based on the file name (e.g. `ğŸ“„ TRT standup - 2025/07/04 14:59 CEST`)
  - followed by the fully formatted content of the note
- Skips the same file in future runs to avoid duplicates (based on file ID)

Currently, the standard method for opening files using openById does not work for documents that contain sections generated by Gemini.

---

## ğŸ”§ Setup Instructions

### 1. **Open Script Editor**

Attach this script to the target Google Docs file where you want notes to accumulate:

- Open the target doc
- Go to `Extensions > Apps Script`
- Paste the script into `Code.gs`

### 2. **Enable Drive Advanced Service**

To support the export/import workaround (which allows preserving formatting), you must enable the **Drive API (v2)**:

1. Find `Services` on the lft hand side, click on `+`
2. Add **Drive API** in version `V3`

### 3. **Optional: Add Time Trigger**

To automate this process daily:

1. In the Apps Script editor, go to `Triggers > + Add Trigger`
2. Choose:
   - Function: `appendNewTRTNotes`
   - Event source: `Time-driven`
3. Save

---

## ğŸ“ Notes

- The script uses the `DocumentApp.getActiveDocument()` contextâ€”run it from the document where you want notes to be collected.
- Only files with correct naming pattern are included.
- Temporary conversion files are cleaned up automatically.

